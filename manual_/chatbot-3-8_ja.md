# 正規表現の入力ガイド

正規表現とは、多様に表現された文章を圧縮して表記できる表記法のことを言います。

さまざまな種類の正規表現の表記法が存在しますが、当ビルダーではnlu_scriptという正規表現式を使用します。以下のガイドから正規表現の文法を覚えれば、自然言語ではカバーできなかった部分を一部補うことができます。

作成方法は以下のとおりです。



## 文法ガイド

### 基本表記法

####  1. special symbols

nlu_scriptで使用するspecial symbolsは、以下のとおりです。

```
( ) { } [ ] < > \ : + * ^ ~ = . | & - / `
```

上記のようなsymbolを正規表現の中で使用したい場合は、 `" `と `"`で囲んで使用する必要があります。



#### 2. **分かち書き**

トークンの間に分かち書きがない場合、分かち書きが含まれているトークンはマッチされません。そのため、用例で分かち書きにしてもいいところは、できるだけ分かち書きにすることをお勧めします。

```
元気ですか
-> 元気ですか (O) / 元気　ですか (X)
元気　ですか
-> 元気ですか、元気　ですか (O)
```

### 基礎表記法

#### 1. [ ]

必須で出てくる発話を表現するときに使用します。

該当の表現は重複して使用できます。

主に必ず出てほしい品詞の表現をまとめる方式で活用できます。

```
[注文|配達|配送]して
-> 注文して、配達して、配送して
```



#### 2. ( )

選択的に出てくる可能性のある発話を表現するときに使用します。

該当の表現は、重複して使用できます。

長い質問で省略できる助詞または修飾語をまとめて表現する方式として活用できます。

```
元気(ですか|かい|か)
-> 元気、元気ですか、元気かい、元気か
```


#### 3. ::

トークン間の繋がりを表すために使用します。

該当の表現は、空白なしに入力する必要があります。

主に語幹::語尾の変形するところを繋ぐために使用されます。

```
く[れ|ださい]
-> くれ、く　れ、ください、く　ださい
く::[れ|ださい]
-> くれ、ください

[ここで|そこで]はきものを ぬいでください　
->ここでは　きものを　ぬいでください、ここで　はきものを　ぬいでください
[ここで|そこで]::は きものを ぬいでください　
->ここでは　きものを　ぬいでください
```

#### 4. " "

正規表現の中に特殊文字を入力するために使用します。

```
元気(か|かい)"?"
-> 元気?、元気か?、元気かい?
```



#### 5. |

ORを意味する論理記号です。

該当の表現は通常、大括弧 `[]` または小括弧`()`と一緒に使用する必要があります。

```
[カロリー|熱量]教えて
-> カロリー教えて、熱量教えて
```



#### 6. ~[ ]~

`~[]~`中に入力されたトークンを組み合わせるために使用します。

入力されたトークンは、`,`で区別します。
ただし、候補のパターンが多すぎることがあるので（順列; permutation) `~[]~` の中に入るトークンは5つ以下に制限します。

```
~[アカウント、作成]~方法
-> アカウント作成方法、作成アカウント方法
```



#### 7. [ ]^

`[]` 中に入力されたトークンを繰り返して組み合わせるために使用します。

- [ ]^(a,b) : `[]` 中に入力されたトークンが、a以上b以下の回数で繰り返されます。
- [ ]^<a : `[]`中に入力されたトークンが、a未満の回数で繰り返されます。
- [ ]^>a : `[]`中に入力されたトークンが、a超過の回数で繰り返されます。

```
[早く]^(1,3)
-> 早く、早く早く、早く早く早く (O) / 早く早く早く早く (X)
[早く]^<3
-> 早く、早く早く (O) / 早く早く早く、早く早く早く早く (X)
[早く]^>2
-> 早く早く早く、早く早く早く早く (O) / 早く、早く早く (X)
```



#### 8. <?>

任意の単語をマッチングするときに使用します。ただし、サイドエフェクト発生することがあるので、必ず必要なときにだけ使用することをお勧めします。

- <?> : 任意の1文字の単語をマッチングします。
- <?>*? : 任意の単語をマッチングします。任意の単語がない場合にもマッチングされます。文字数の制限はありません。
- <?>+? : 任意の単語をマッチングします。任意の単語がない場合にはマッチングされません。文字数の制限はありません。

```
[おはよう]<?>
-> おはよう? (O) / おはようチョルス (X)
[おはよう]<?>*?
-> おはよう、おはようチョルス (O)
[おはよう]<?>+?
-> おはようチョルス (O) / おはよう (X)
[おはよう]<ございます>*?
-> おはようございます、おはようございます、チョルスさん (O) / おはようチョルスさん (X)
```



#### 9. \

マッチングされてはならない発話内に例外トークンを指定するときに使用します。wildcardの前後に例外トークンを入力し、ユーザーの多様な発話に対して制限を入れることができます。

```
[\キム・チョルス] <?>^<5 [悲しい|いい|楽しい] 歌を流して
-> いい歌を流して (O) / キム・チョルスいい歌を流して (X)
```



#### 10. @{ } 、`@{ }

ビルダーの中に登録されているドメインエンティティとシステムエンティティを入力するときに使用します。

```
[登録されているドメインエンティティ]
@メニュー : チキン、ピザ

@{メニュー}[注文|デリバリー]
-> チキン注文、チキンデリバリー、ピザ注文、ピザデリバリー

[登録されているシステムエンティティ]
`@{TELNUM}

`@{TELNUM}[照会|確認]して
-> 010-0000-0000 照会して、010-1234-5678 照会して...
```



## 関連情報へのリンク

ドメインの作成、Conversation Listとコンポーネントの管理および統計管理に関しては以下の利用ガイドを参照してください。

- Chatbotスタートガイド
  - [チャットボットを開発する前に考えること](chatbot-1-2_ja.md)
  - [チャットボットのクイックスタートガイド](chatbot-1-1_ja.md)
  - [チャットボットのよくある質問](chatbot-1-3_ja.md)    
- Chatbotご利用ガイド
  - [ドメイン管理](chatbot-3-1_ja.md)
　- [Conversation Listの管理](chatbot-3-2_ja.md)  
  - [会話コンポーネントの管理](chatbot-3-3_ja.md)
  - [統計の管理](chatbot-3-4_ja.md)
  - [チャットボットのAdvancedガイド](chatbot-3-5_ja.md)
  - [正規表現の入力ガイド](chatbot-3-8_ja.md)
  - [チャットボットのCustom API Spec.](chatbot-3-7_ja.md)
- チャンネル連動ガイド
  - [LINE連動](chatbot-2-1_ja.md)
- Agent Connectionsガイド
  - [LINE Switcher API連動](chatbot-2-7_ja.md)
